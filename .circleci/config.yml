version: 2.1
orbs:
  heroku: circleci/heroku@1.0.1
jobs:
  CI:
    docker:
      - image: circleci/node:9.8      
    steps:
     - checkout
     - restore_cache:
        key: npm-install-{{ .Branch}}-{{ checksum "package.json" }}      
     - run: npm install
     - save_cache:
        key: npm-install-{{ .Branch}}-{{ checksum "package.json" }}
        paths: 
          -node_modules   
     - run: ./node_modules/.bin/eslint ./
  CD:
          jobs:           
           - heroku/deploy-via-git:
               requires:
                 - CI # only run deploy-via-git job if the build job has completed
               filters:
                 branches:
                   only: master # only run deploy-via-git job on master branch    
     workflows:
        CICD:
        -CI
        - CD
